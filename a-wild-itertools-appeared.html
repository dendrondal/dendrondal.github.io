<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#">
<head>
  <meta charset="UTF-8" />
  <title>A wild itertools appeared! | Dal&#39;s Portfolio</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="/static/m-dark.css" />
  <link rel="icon" href="/images/favicon.ico" type="image/x-ico" />
  <link rel="canonical" href="/a-wild-itertools-appeared.html" />
  <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Dal&#39;s Portfolio" />
  <link href="/feeds/blog.atom.xml" type="application/atom+xml" rel="alternate" title="Dal&#39;s Portfolio | Blog" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#353535" />
  <meta name="twitter:site" content="@dendrondal" />
  <meta property="og:site_name" content="Dal&#39;s Portfolio" />
  <meta property="og:title" content="A wild itertools appeared!" />
  <meta name="twitter:title" content="A wild itertools appeared!" />
  <meta property="og:url" content="/a-wild-itertools-appeared.html" />
  <meta property="og:description" content="A walkthrough and deployment use cases of the itertools standard library" />
  <meta name="twitter:description" content="A walkthrough and deployment use cases of the itertools standard library" />
  <meta name="twitter:card" content="summary" />
  <meta property="og:type" content="article" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="/" id="m-navbar-brand" class="m-col-t-9 m-col-m-none m-left-m"><img src="/images/tree.jpg" alt="" />Dal&#39;s Portfolio</a>
      <a id="m-navbar-show" href="#navigation" title="Show navigation" class="m-col-t-3 m-hide-m m-text-right"></a>
      <a id="m-navbar-hide" href="#" title="Hide navigation" class="m-col-t-3 m-hide-m m-text-right"></a>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-12 m-col-m-none">
            <li><a href="/pages/about-me.html">About</a></li>
            <li><a href="https://github.com/dendrondal">GitHub</a></li>
            <li><a href="https://linkedin.com/in/dal-williams">LinkedIn</a></li>
            <li><a href="https://twitter.com/dendrondal">Twitter</a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main>
<div class="m-container">
  <div class="m-row">
    <article class="m-col-m-10 m-nopadb">
      <header>
        <h1><a href="/a-wild-itertools-appeared.html" rel="bookmark" title="Permalink to A wild itertools appeared!">
          <time class="m-date" datetime="2019-08-23T00:00:00-05:00">
            Aug <span class="m-date-day">23</span> 2019
          </time>
          A wild itertools appeared!
        </a></h1>
        <p>A walkthrough and deployment use cases of the itertools standard library</p>
      </header>
      <div class="m-clearfix-l"></div>
<!-- content -->
<section id="about-this-series">
<h2>About this series</h2>
<p>This blog post is the first of a new series I’m starting called “Wild
Python,” aka use cases of selected python libraries in deployment. Posts
of this series will generally consist of a breakdown of the library and
intended use cases, followed by several examples of how it is used in
the context of several popular GitHub repositories. This series will be
continually ongoing, partially to act as a personal refresher course.</p>
</section>
<section id="what-is-itertools">
<h2>What is <em>itertools</em>?</h2>
<p>Itertools is Python implementation of a common design pattern to stream
data in <a href="https://www.dataquest.io/blog/introduction-functional-programming-python/">functional
programming</a>.
Effectively, this allows a way to take an iterable
(<code>list, tuple, dict, string</code> etc.) and apply a very succinct method to
lazily iterate through them based on several commonly used pieces of
logic. Let’s take a toy example, one of the <a href="https://www.tomdalling.com/blog/software-design/fizzbuzz-in-too-much-detail/">most overused interview
questions</a>:</p>
<pre class="m-code"><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">cycle</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">islice</span>

<span class="n">fizzes</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;fizz&#39;</span><span class="p">])</span>
<span class="n">buzzes</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;buzz&#39;</span><span class="p">])</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fizzbuzz</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fizz</span><span class="si">}{</span><span class="n">buzz</span><span class="si">}</span><span class="s1">&#39;</span> <span class="ow">or</span> <span class="n">n</span>
            <span class="k">for</span>  <span class="n">fizz</span><span class="p">,</span> <span class="n">buzz</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fizzes</span><span class="p">,</span> <span class="n">buzzes</span><span class="p">,</span> <span class="n">numbers</span><span class="p">))</span>
<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">islice</span><span class="p">(</span><span class="n">fizzbuzz</span><span class="p">,</span> <span class="mi">16</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></pre>
<pre>1
2
fizz
4
buzz
fizz
7
8
fizz
buzz
11
fizz
13
14
fizzbuzz
16</pre>
<p>Let’s break this down: <code>itertools.cycle</code> consumes an iterator, then
loops back over it from the beginning infinitely, or until a stop
condition is reached. As the name implies, this is very useful for
cyclic or periodic data. <code>count</code> is another infinite iterator, that
accepts a “start” and “step” argument, similar to <code>range()</code> Finally,
we have <code>islice</code>, another piece of syntactic sugar that is equivalent
to <code>for i in range(number): do_something(iterable[i])</code></p>
<p>However, in addition to being more readable, this has the advantage of
speed and memory efficiency. The <code>for</code> loop above using <code>range</code>
would most likely be used with a previously existing iterable, which is
stored in RAM. This is opposed to the <code>islice</code> implementation, which
doesn’t store any values, only using RAM in the case that it is called.
Note that an equivalent alternative to the islice implementation above
is to say <code>for i in range(16): print(next(fizzbuzz))</code> Next is an
important method to keep in mind when working with generators.</p>
<p>Let’s do another example with another favorite interview question, the
<a href="https://en.wikipedia.org/wiki/Knapsack_problem">Knapsack Problem</a>,
approximated using a brute-force approach:</p>
<pre class="m-code"><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>

<span class="n">item</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Item&#39;</span><span class="p">,</span> <span class="s1">&#39;name value mass&#39;</span><span class="p">)</span>
<span class="n">pants</span> <span class="o">=</span> <span class="n">item</span><span class="p">(</span><span class="s1">&#39;pants&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">shirt</span> <span class="o">=</span> <span class="n">item</span><span class="p">(</span><span class="s1">&#39;shirt&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">shoes</span> <span class="o">=</span> <span class="n">item</span><span class="p">(</span><span class="s1">&#39;shoes&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">stove</span> <span class="o">=</span> <span class="n">item</span><span class="p">(</span><span class="s1">&#39;stove&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">socks</span> <span class="o">=</span> <span class="n">item</span><span class="p">(</span><span class="s1">&#39;socks&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">water</span> <span class="o">=</span> <span class="n">item</span><span class="p">(</span><span class="s1">&#39;water&#39;</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">tent</span> <span class="o">=</span> <span class="n">item</span><span class="p">(</span><span class="s1">&#39;tent&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">hammock</span> <span class="o">=</span> <span class="n">item</span><span class="p">(</span><span class="s1">&#39;hammock&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">headlamp</span> <span class="o">=</span> <span class="n">item</span><span class="p">(</span><span class="s1">&#39;headlamp&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">possibilities</span> <span class="o">=</span> <span class="p">[</span><span class="n">pants</span><span class="p">,</span> <span class="n">shirt</span><span class="p">,</span> <span class="n">shoes</span><span class="p">,</span> <span class="n">stove</span><span class="p">,</span> <span class="n">socks</span><span class="p">,</span>
                 <span class="n">water</span><span class="p">,</span> <span class="n">tent</span><span class="p">,</span> <span class="n">hammock</span><span class="p">,</span> <span class="n">headlamp</span><span class="p">]</span>

<span class="c1">#assuming a knapsack that can carry 10kg:</span>
<span class="n">max_weight</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">possibilities</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">possibilities</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="n">thing</span><span class="o">.</span><span class="n">mass</span> <span class="k">for</span> <span class="n">thing</span> <span class="ow">in</span> <span class="n">combination</span><span class="p">])</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">answer</span> <span class="o">=</span> <span class="s1">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">thing</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">thing</span> <span class="ow">in</span> <span class="n">combination</span><span class="p">])</span>
    <span class="n">error</span> <span class="n">output</span> <span class="n">required</span> <span class="nb">property</span> <span class="n">nbconvert</span>        <span class="n">max_weight</span><span class="p">[</span><span class="n">answer</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">thing</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">thing</span> <span class="ow">in</span> <span class="n">combination</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">max_weight</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span></pre>
<pre>[('pants+socks+hammock+headlamp', 180), ('shirt+shoes+socks+headlamp', 160), ('shirt+shoes+hammock+headlamp', 150), ('pants+shoes+socks', 140), ('pants+shoes+hammock', 130), ('shirt+socks+water', 130), ('stove+socks+headlamp', 130), ('shirt+stove+socks+hammock', 130), ('water+headlamp', 120), ('shirt+water+hammock', 120), ('stove+hammock+headlamp', 120), ('socks+tent+headlamp', 120), ('shirt+socks+tent+hammock', 120), ('tent+hammock+headlamp', 110), ('pants+shirt+headlamp', 100), ('shoes+stove', 80), ('shoes+tent', 70)]</pre>
<p><em>Note: This is neither</em><a href="http://www.es.ele.tue.nl/education/5MC10/Solutions/knapsack.pdf">the most efficient
solution</a><em>,
nor is it recommended to go out into the wilderness without a shirt or
shoes.</em></p>
<p>Let’s break this down: we have several items with a cost and weight
associated with them. There are many data structures that can represent
this, but I decided to go with named tuples for clarity’s sake (this
will probably warrant another Wild Python article). We then iterate
through all possible combinations of items by finding combinations of
different length within a nested for loop. We add them to a dictionary
if it maxes out the knapsack carrying capacity. Finally, we see what the
highest value combination is by ordering the resulting dictionary by
values rather than keys, then reversing it. We now have a very fast and
memory-efficient brute force solution! ### Chain chain chain One method
that deserves some additional explanation is <code>chain</code>
vs. <code>chain_from_iterable</code>. Chain takes two or more iterables as
arguments, and chains them together, consuming them in the order passed.
From_iterable takes a <em>single</em> iterator as an argument, effectively
flattening it (think smushing a matrix into an array)</p>
</section>
<section id="production-use-cases">
<h2>Production use cases</h2>
<p><a href="https://www.tensorflow.org/guide/keras">Keras</a> utilizes
<code>itertools.compress</code> to check whether all functions have been properly
documented:</p>
<pre class="m-code"><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">compress</span>
<span class="k">def</span> <span class="nf">assert_args_presence</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">member</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="n">args_not_in_doc</span> <span class="o">=</span> <span class="p">[</span><span class="n">arg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">doc</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">args_not_in_doc</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> arguments are not present in documentation &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span>
                <span class="n">compress</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">args_not_in_doc</span><span class="p">))),</span> <span class="n">member</span><span class="o">.</span><span class="vm">__module__</span><span class="p">)</span></pre>
<p>Compress is usually used to map an iterable to the “truthiness” of
individual components of that iterable. The list comprehension above
contains booleans based on list membership, which is then mapped back
onto the function arguments during the string formatting. This tells
anyone submitting a pull request exactly what function arguments need to
be documented.</p>
<p><a href="https://numba.pydata.org/">Numba</a>, a just-in-time compiler for
scientific computing with Python, uses itertools extensively in their
test suite:</p>
<pre class="m-code"><span class="k">def</span> <span class="nf">test_slice_passing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check passing a slice object to a Numba function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># NOTE this also checks slice attributes</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="n">sl</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="n">got</span> <span class="o">=</span> <span class="n">cfunc</span><span class="p">(</span><span class="n">sl</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertPreciseEqual</span><span class="p">(</span><span class="n">got</span><span class="p">,</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>

<span class="n">cfunc</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">slice_passing</span><span class="p">)</span>
<span class="c1"># Positive steps</span>
    <span class="n">start_cases</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
    <span class="n">stop_cases</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxposint</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">)]</span>
    <span class="n">step_cases</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">)]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">e</span><span class="p">),</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">start_cases</span><span class="p">,</span>
                                                    <span class="n">stop_cases</span><span class="p">,</span>
                                                    <span class="n">step_cases</span><span class="p">):</span>
        <span class="n">check</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span></pre>
<p>These tests ensure that the JIT variant of the function has the same
output as the python one. In order to make this test robust, they run it
on a variety of different inputs. The <code>product</code> is the cartesian
product of this function, effectively a nested for loop. This is an
efficient way to test a wide variety of sample cases in just a few lines
of code.</p>
<p>Another Numfocus library, <a href="https://docs.dask.org/en/latest/">Dask</a>,
leads us to <code>starmap</code>. Unlinke <code>map</code>, which applies a function
across every item in an iterable, <code>starmap</code>effectively works on
“pre-zipped” data (effectively an “iterable of iterables”). Dask wrote
their own variant of this, allowing for keyword arguments in addition to
iterables. In the code below, note that “bag (db)” just represents a
generic python object which can have multithreaded methods called on it
using method chaining.</p>
<pre class="m-code"><span class="k">def</span> <span class="nf">starmap</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">bag</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">args</span> <span class="ow">in</span> <span class="n">bag</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">dask.bag</span> <span class="k">as</span> <span class="nn">db</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">from_sequence</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">#Apply a function to each argument tuple:</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">add</span>
<span class="n">b</span><span class="o">.</span><span class="n">starmap</span><span class="p">(</span><span class="n">add</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="c1"># returns [3, 7, 11, 15, 19]</span>

<span class="c1">#Apply a function to each argument tuple, with additional kwargs:</span>
<span class="k">def</span> <span class="nf">myadd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
     <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span>
<span class="n">b</span><span class="o">.</span><span class="n">starmap</span><span class="p">(</span><span class="n">myadd</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="c1"># returns [13, 17, 21, 25, 29]</span></pre>
<p>Obviously whether to use <code>map</code> or <code>starmap</code> depends on the structure
of the iterable being fed in, but…</p>
</section>
<section id="considerations-regarding-readability">
<h2>Considerations regarding readability</h2>
<p>You might notice that some itertools code is less “Pythonic” than a lot
of code out there. Given how clear list comprehensions can be, it’s
understandable that the traditional <code>reduce</code> funcitonalicty was moved
to functools rather than the global namespace. In addition, performance
gains are
<a href="https://stackoverflow.com/questions/1247486/list-comprehension-vs-map">trivial</a>
when switching from <code>map</code> to a list comprehension. With this in mind,
unless you are concerned about fitting data structures in RAM, your
first-pass attempt should probably be a list comprehension rather than
reaching for the functools toolkit, as this makes for more readable and
maitainable code.</p>
</section>
<section id="final-thoughts">
<h2>Final Thoughts</h2>
<p>For additional use cases utilizing itertools, the <a href="https://docs.python.org/3.7/library/itertools.html#itertools-recipes">Python
documentation</a>
has some very helpful recipes. The next time you’re trying to do some
sort of iteration on large data, or working with a heavily nested
<code>for</code> loop, be lazy, and reach for itertools instead!</p>
</section>
<!-- /content -->
      <footer>
        <p>Posted by <a href="/author/jon-steven-dal-williams.html">Jon Steven Dal Williams</a> on <time datetime="2019-08-23T00:00:00-05:00">Fri 23 August 2019</time> in <a href="/category/blog.html">Blog</a>. Tags: <a href="/tag/wild-python.html">wild python</a>, <a href="/tag/functional-programming.html">functional programming</a>, <a href="/tag/tutorials.html">tutorials</a>.</p>
      </footer>
    </article>
    <nav class="m-navpanel m-col-m-2">
      <h3>Categories</h3>
      <ol class="m-block-bar-m">
        <li><a href="/category/blog.html">Blog</a></li>
        <li><a href="/category/projects.html">Projects</a></li>
        <li><a href="/category/talks.html">Talks</a></li>
        <li><a href="/category/tutorials.html">Tutorials</a></li>
      </ol>
      <h3>Tag cloud</h3>
      <ul class="m-tagcloud">
        <li class="m-tag-3"><a href="/tag/airflow.html">Airflow</a></li>
        <li class="m-tag-3"><a href="/tag/altair.html">Altair</a></li>
        <li class="m-tag-3"><a href="/tag/aws.html">AWS</a></li>
        <li class="m-tag-3"><a href="/tag/bash.html">Bash</a></li>
        <li class="m-tag-3"><a href="/tag/bayesian-stats.html">Bayesian stats</a></li>
        <li class="m-tag-3"><a href="/tag/chatbots.html">chatbots</a></li>
        <li class="m-tag-3"><a href="/tag/chemistry.html">chemistry</a></li>
        <li class="m-tag-3"><a href="/tag/cnns.html">CNNs</a></li>
        <li class="m-tag-3"><a href="/tag/computer-vision.html">computer vision</a></li>
        <li class="m-tag-5"><a href="/tag/flask.html">Flask</a></li>
        <li class="m-tag-3"><a href="/tag/functional-programming.html">functional programming</a></li>
        <li class="m-tag-3"><a href="/tag/gans.html">GANs</a></li>
        <li class="m-tag-3"><a href="/tag/jupyter.html">Jupyter</a></li>
        <li class="m-tag-3"><a href="/tag/keras.html">Keras</a></li>
        <li class="m-tag-3"><a href="/tag/latex.html">LaTeX</a></li>
        <li class="m-tag-3"><a href="/tag/luigi.html">Luigi</a></li>
        <li class="m-tag-3"><a href="/tag/make.html">Make</a></li>
        <li class="m-tag-3"><a href="/tag/markdown.html">Markdown</a></li>
        <li class="m-tag-3"><a href="/tag/microsoft.html">Microsoft</a></li>
        <li class="m-tag-5"><a href="/tag/mission-driven-data-science.html">Mission-driven data science</a></li>
        <li class="m-tag-3"><a href="/tag/mongodb.html">MongoDB</a></li>
        <li class="m-tag-3"><a href="/tag/pandas.html">Pandas</a></li>
        <li class="m-tag-3"><a href="/tag/papermill.html">Papermill</a></li>
        <li class="m-tag-3"><a href="/tag/pytorch.html">PyTorch</a></li>
        <li class="m-tag-3"><a href="/tag/reproducibility.html">reproducibility</a></li>
        <li class="m-tag-3"><a href="/tag/rest.html">REST</a></li>
        <li class="m-tag-3"><a href="/tag/science-writing.html">Science Writing</a></li>
        <li class="m-tag-3"><a href="/tag/scikit-learn.html">SciKit Learn</a></li>
        <li class="m-tag-3"><a href="/tag/spacy.html">Spacy</a></li>
        <li class="m-tag-3"><a href="/tag/sqalchemy.html">SQAlchemy</a></li>
        <li class="m-tag-3"><a href="/tag/sqlite.html">SQLite</a></li>
        <li class="m-tag-3"><a href="/tag/swagger.html">Swagger</a></li>
        <li class="m-tag-3"><a href="/tag/tensorflow.html">TensorFlow</a></li>
        <li class="m-tag-5"><a href="/tag/tutorials.html">tutorials</a></li>
        <li class="m-tag-3"><a href="/tag/vaes.html">VAEs</a></li>
        <li class="m-tag-3"><a href="/tag/wild-python.html">wild python</a></li>
      </ul>
    </nav>
  </div>
</div>
</main>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Dal's Portfolio. Powered by <a href="https://getpelican.com">Pelican</a> and <a href="https://mcss.mosra.cz">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>